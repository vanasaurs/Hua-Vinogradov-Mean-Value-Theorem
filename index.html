<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Hua's Vinogradov Mean Value Theorem</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
  type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Hua's Vinogradov Mean Value Theorem</h1>
</header>
<p>The following version of Vinogradov’s Mean Value Theorem is an<br />
improvement edition by Loo-Keng Hua.</p>
<p><strong>Theorem.</strong> Let <span class="math inline">\(P\)</span>
and <span class="math inline">\(T\)</span> be integers and <span
class="math inline">\(P \ge 2\)</span>, <span
class="math display">\[f(x) = \alpha_k x^k + \cdots + \alpha_1
x,\]</span> and <span class="math display">\[C_k = C_k(P) = \sum_{T &lt;
x \le T+P} e(f(x)).\]</span> Then, when <span class="math inline">\(s =
s(k) \geq \tfrac{1}{4}k(k+1)+k\)</span>, we have <span
class="math display">\[\int_0^1 \cdots \int_0^1 |C_k|^{2s}\, d\alpha_1
\cdots d\alpha_k
\;\;\le\;\; (5s)^{5s\ell} (\log P)^{2\ell} P^{2s - \tfrac{1}{2}k(k+1) +
\delta},\]</span> where <span class="math display">\[\delta = \delta(k)
= \tfrac{1}{2}k(k+1)(1-a) + k,
\qquad a = \tfrac{1}{k}.\]</span> <em>Note.</em> The value of this
integral is equal to the number of sets of solutions of the equation
<span class="math display">\[x_1^h + \cdots + x_s^h = y_1^h + \cdots +
y_s^h, \qquad 1 \le h \le k,\]</span> with <span
class="math display">\[T &lt; x_i, \; y_i \le T+P.\]</span> For the sake
of proving, we let <span class="math inline">\(T=0\)</span> from now
on.</p>
<p><strong>Proof.</strong> First we show that the theorem follows from
the following lemma.</p>
<p><strong>Lemma.</strong> Let <span class="math inline">\(b\)</span> be
an integer <span class="math inline">\(\ge \tfrac{1}{4}k(k+1)+k\)</span>
and let <span class="math inline">\(\eta = \left[ \tfrac{1}{k}
\tfrac{\log Q}{\log 2} \right],\;\; a = \tfrac{1}{k}\)</span>. Then
<span class="math display">\[\begin{aligned}
\int_0^1 \cdots \int_0^1 |C_k(Q)|^{2b}\, &amp;d\alpha_1 \cdots
d\alpha_k\le (5b)^{5b} \max(1,\eta^2)\, Q^{\,2k - \tfrac{1}{2}k(k+1) +
2(b-k)a}
\\&amp; \times \int_0^1 \cdots \int_0^1 |C_k(Q^{1-a})|^{2(b-k)}
d\alpha_1 \cdots d\alpha_k .\end{aligned}\]</span></p>
<p>Then we show that this recursion formula can be obtained by
separating <span class="math inline">\(C_k(Q)\)</span> into so-called
"well-spaced” sums, and since the construction of these sums gives us
information over their sizes, it allows us to bound the integral.</p>
<p>We prove the theorem by proceeding by induction progress over <span
class="math inline">\(\ell\)</span>. If <span
class="math inline">\(\ell=0\)</span>, then the theorem is obviously
true. If <span class="math inline">\(\ell \ge 1\)</span>, we assume that
<span class="math inline">\(P^{1-a} &gt; 3\)</span>, then <span
class="math inline">\(P &gt; e\)</span>, otherwise <span
class="math inline">\(P \le 9\)</span>, which is obviously true. And by
the induction hypothesis, we have <span
class="math display">\[\begin{aligned}
    \int_0^1 \cdots \int_0^1 &amp;|C_k(P^{1-a})|^{2(s-k)} d\alpha_1
\cdots d\alpha_k
\\ &amp;\le (5s)^{5s(\ell-1)} (\log P)^{2(\ell-1)}
P^{(1-a)(2s - 2k - \tfrac{1}{2}k(k+1) +
\tfrac{1}{2}k(k+1)(1-a)^{\ell-1})}.\end{aligned}\]</span> Therefore, the
theorem follows by combining this bound with the lemma where <span
class="math inline">\(b = s\)</span>.</p>
<p>Hence, we are left to prove the recursion formula.</p>
<p>We define a set of integers <span
class="math inline">\((g_1,\ldots,g_b),\; 1 \le g_i \le H,\; i \in
[1,b]\)</span> to be a well–spaced set if there exists a <span
class="math inline">\(k\)</span>–set <span
class="math inline">\(g_{j_1},\ldots,g_{j_k}\)</span> with <span
class="math display">\[|g_{j_{i+1}} - g_{j_i}| &gt; 1 \quad \text{for }
1 \le i \le k-1.\]</span> Then, by a rough estimation, the number of
sets which are not well–spaced are at most <span
class="math display">\[H^{\,k-1}(2(k-1))^b.\]</span></p>
<p>Suppose <span class="math inline">\(\eta \ge 2\)</span>, and let
<span class="math inline">\(s\)</span> denote an integer with <span
class="math inline">\(1 \le s \le \eta-1\)</span>. By splitting <span
class="math inline">\(C_k(Q)\)</span> into <span
class="math inline">\(2^s\)</span> parts whose length of each part is
<span class="math inline">\(R_s = Q 2^{-s}\)</span>, it follows <span
class="math display">\[C_k(Q) = \sum_{g=1}^{2^s} \sum_{(g-1)R_s &lt; x
\le gR_s} e(f(x))
= \sum_{g=1}^{2^s} Z_{sg},\]</span> where <span
class="math display">\[Z_{sg} = \sum_{(g-1)R_s &lt; x \le gR_s}
e(f(x)).\]</span></p>
<p>Let <span class="math display">\[Z = (C_k(Q))^b.\]</span> Then <span
class="math display">\[Z = \sum_{g=1}^{2^{sb}} Z_{sg_1} \cdots Z_{sg_b}
= \sum_{s_{g_1},\ldots,s_{g_b}} Z_{s;g_1,\ldots,g_b}
= \sum_{}^{2^{sb}} Z_j,\]</span> where <span
class="math inline">\(\sum^M\)</span> denotes a sum, the number of terms
at most <span class="math inline">\(M\)</span>.</p>
<p>Now, we define <span
class="math inline">\(Z_{s;g_1,\ldots,g_b}\)</span> to be a well–spaced
sum if <span class="math inline">\(g_1,\ldots,g_b\)</span> is a
well–spaced set, and we denote it as <span
class="math inline">\(Z_s&#39;\)</span>. For each not well–spaced <span
class="math inline">\(Z_s\)</span>, we divide each of the factors of
<span class="math inline">\(Z_s\)</span>, then we obtain <span
class="math inline">\(2^b\)</span> sums <span
class="math inline">\(Z_{s+1}\)</span>, i.e. at most <span
class="math inline">\((4(k-1))^b 2^{s(k-1)}\)</span> of well–spaced
<span class="math inline">\(Z_{s+1}&#39;\)</span>. We repeat this
process over <span class="math inline">\(s\)</span> from <span
class="math inline">\(1\)</span> to <span
class="math inline">\(\eta-1\)</span>, and use <span
class="math inline">\(Z_\eta&#39;\)</span> to denote all <span
class="math inline">\(Z_\eta\)</span> obtained from the <span
class="math inline">\(Z_{\eta-1}\)</span> which are not well–ordered.
Therefore, we can express <span class="math display">\[Z =
\sum_{s=1}^\eta M_s \sum_{}^{M_s} Z_s&#39;,\]</span> where <span
class="math inline">\(M_s = (4(k-1))^b \, 2^{s(k-1)}\)</span>. It
follows that <span class="math display">\[|C_k(Q)|^{2b} = |Z|^2 \le \eta
\sum_{s=1}^\eta M_s \sum_{}^{M_s} |Z_s&#39;|^2.\]</span></p>
<p>We then rearrange the indices of <span
class="math inline">\(Z_s&#39;\)</span> (<span class="math inline">\(s
\le \eta-1\)</span>) where the first <span
class="math inline">\(k\)</span> terms of the factor form a well–spaced
sum. For the rest of the terms, since <span class="math inline">\(4 \le
2^\eta \le Q^a\)</span>, we can split <span
class="math display">\[Z_{sg_i} \,(1 \le i \le b) \quad \text{into }
\left\lfloor \frac{Q 2^{-s}}{Q^{1-a}} \right\rfloor +1 \le Q^a 2^{1-s}
\;\;\text{parts},\]</span> each of length <span
class="math inline">\(Q&#39; \le Q^{1-a}\)</span>.</p>
<p>Let <span class="math display">\[C^* = \max_{T \in [0,Q]}
|C_k(Q&#39;)|
= \left| \sum_{\omega &lt; x \le \omega + Q&#39;} e(f(x))
\right|,\]</span> then <span class="math display">\[|Z_{sg_i}|^{2(b-k)}
\le (Q^a 2^{1-s} C^*)^{2(b-k)},\]</span> and <span
class="math display">\[|Z|^2 \le \eta \sum_{s=1}^\eta M_s \,(Q^a 2^{1-s}
C^*)^{2(b-k)} \sum_{}^{M_s} |Z_{sg_1\ldots g_k}|^2.\]</span></p>
<p>Therefore, by integrating both sides over the <span
class="math inline">\(k\)</span>–dimensional unit cube (<span
class="math inline">\(0 &lt; \alpha_i \le 1,\; 0 \le \alpha_k \le
1\)</span>), we obtain <span class="math display">\[\begin{aligned}
\int_0^1 \cdots \int_0^1 |Z|^2 d\alpha_1 \cdots &amp;d\alpha_k
\;\;\le\;\; \eta \sum_{s=1}^\eta M_s (Q^a 2^{1-s})^{2(b-k)}
\\ &amp;\times \sum_{}^{M_s} \int_0^1 \cdots \int_0^1 (C^*)^{2(b-k)}
\big| Z_{sg_1} \cdots Z_{sg_k} \big|^2 d\alpha_1 \cdots
d\alpha_k.\end{aligned}\]</span></p>
<p>The integral is equivalent to the number of solutions of the
equations <span class="math display">\[x_1^h + \cdots + x_k^h + y_1^h +
\cdots + y_b^h
= x_1&#39;^h + \cdots + x_k&#39;^h + y_1&#39;^h + \cdots + y_b&#39;^h,
\, (1 \le h \le k),\]</span> where <span
class="math display">\[(g_{j-1}-1) R_s &lt; x_i, x_i&#39; \le g_j
R_s\]</span> and <span class="math display">\[\omega &lt; y_i, y_i&#39;
\le \omega + Q&#39;.\]</span></p>
<p>Note: the difference between <span class="math display">\[x_1^h +
\cdots + x_b^h, \quad x_1&#39;^h + \cdots + x_b&#39;^h\]</span> must not
exceed <span class="math inline">\(2(b-k) Q^{(1-a)h}\)</span>; and for
fixed <span class="math inline">\(x_i, x_i&#39;\)</span> that equip with
the above condition, the number of sets of <span
class="math inline">\(y_i, y_i&#39;\)</span> does not exceed <span
class="math display">\[\int_0^1 \cdots \int_0^1 |C_k(Q^{1-a})|^{2(b-k)}
d\alpha_1 \cdots d\alpha_k,\]</span> since it is equivalent to <span
class="math display">\[\int_0^1 \cdots \int_0^1
C^{\,b-k}_k(Q&#39;)\,\overline{C^{\,b-k}_k(Q&#39;)}\,
e(N_1\alpha_1 + \cdots + N_k\alpha_k)\, d\alpha_1 \cdots
d\alpha_k.\]</span><br />
<strong>Lemma.</strong> Let <span class="math inline">\(Q = RH\)</span>,
<span class="math inline">\(R &gt; 1\)</span>, <span
class="math inline">\(H &gt; 1\)</span> and <span
class="math display">\[1 \le g_1 &lt; \cdots &lt; g_k \le H, \qquad
g_\nu - g_{\nu-1} &gt; 1,\]</span> where <span
class="math inline">\(g_1, \ldots, g_k\)</span> are integers. Further,
let <span class="math inline">\(x_\nu\)</span> vary over the interval
<span class="math display">\[-\omega + (g_\nu - 1)R \;\le\; x_\nu
\;&lt;\; -\omega + g_\nu R\]</span> for <span
class="math inline">\(\omega\)</span> any integer, <span
class="math inline">\(0 \le \omega \le Q\)</span>. Then, the number of
sets <span class="math inline">\(x_1, \ldots, x_k\)</span> such that
<span class="math display">\[|x_1^h + \cdots + x_k^h - x_1&#39;^h -
\cdots - x_k&#39;^h| \;\le\; Q^{h-1},
\qquad (1 \le h \le k),\]</span> for some fixed <span
class="math inline">\(x_1&#39;, \ldots, x_k&#39;\)</span>, is <span
class="math display">\[\le 2^k (2kH)^{\tfrac{1}{2}k(k-1)}.\]</span></p>
<p>The proof of this lemma is based on inductions over the difference of
elementary symmetric functions of the <span
class="math inline">\(h\)</span>th degree of <span
class="math inline">\(x_1, \ldots, x_k\)</span> and <span
class="math inline">\(x_1&#39;, \ldots, x_k&#39;\)</span>. Since we have
information on the difference of their power functions, by the induction
hypothesis of assuming the first <span
class="math inline">\(h-1\)</span> terms are correct, it is not
difficult to show it is also correct for the <span
class="math inline">\(h\)</span>th term by considering Newton’s
identity. Then, we define <span class="math display">\[\varphi(x) = |(x
- x_1)(x - x_2)\cdots(x - x_k) - (x - x_1&#39;)(x - x_2&#39;)\cdots(x -
x_k&#39;)|\]</span> and thus we can bound it for <span
class="math inline">\(|x| \le Q\)</span> by the difference of elementary
symmetric functions.</p>
<p>Thus, let <span class="math inline">\(x = x_i\)</span>, it gives
information of <span class="math inline">\(|x_i^k - x_i&#39;^k|\)</span>
and the lemma follows from the induction hypothesis for <span
class="math inline">\(k-1\)</span>.</p>
<p>Hence, for <span class="math inline">\(1 \le h \le k\)</span> with
<span class="math display">\[|x_1^h + \cdots + x_k^h - x_1&#39;^h -
\cdots - x_k&#39;^h| \;\le\; 2(b-k)\, Q^{(1-a)h},\]</span> we simply
split this interval into <span class="math inline">\(Q^{a h}\)</span>
sub-intervals, and get the number of sets of <span
class="math inline">\(x_1,\ldots,x_k\)</span> and <span
class="math inline">\(x_1&#39;,\ldots,x_k&#39;\)</span> that do not
exceed <span class="math display">\[(8(b-k))^k
(2k2^s)^{\tfrac{1}{2}k(k-1)} Q^{\tfrac{1}{2}(k-1)} R_s^k.\]</span>
Therefore, we obtain the upper bound for <span class="math inline">\(1
\le s \le \eta-1\)</span>.</p>
<p>For <span class="math inline">\(s = \eta\)</span>, we use the trivial
bound <span class="math display">\[|Z_{sg_1} \cdots Z_{sg_k}| \le
R_\eta^{2k},\]</span> and thus we can show the lemma is true for <span
class="math inline">\(\eta \ge 2\)</span>.</p>
<p>If <span class="math inline">\(\eta &lt; 2\)</span>, then <span
class="math display">\[\frac{1}{k} \frac{\log Q}{\log 2} &lt; 2,
\qquad \text{i.e. } Q &lt; 4^k.\]</span> Then we simply split <span
class="math inline">\(C_k(Q)\)</span> into <span
class="math inline">\(4^k\)</span> parts and each part sums over length
<span class="math inline">\(Q&#39; \le \tfrac{1}{4} Q \le
Q^{1-a}\)</span>.</p>
<p>Hence, we obtain the lemma and complete the proof for the
theorem.</p>
</body>
</html>
